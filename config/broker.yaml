container:
  image: 'docker.redpanda.com/redpandadata/redpanda:v23.3.2'
  container_name: broker
  command:
    - redpanda
    - start
    - --kafka-addr internal://0.0.0.0:9092,external://0.0.0.0:19092
    # Address the broker advertises to clients that connect to the Kafka API.
    # Use the internal addresses to connect to the Redpanda brokers'
    # from inside the same Docker network.
    # Use the external addresses to connect to the Redpanda brokers'
    # from outside the Docker network.
    - '--advertise-kafka-addr internal://broker_{{ MORIO_NODE_NR }}:9092,external://{{{ MORIO_DEPLOYMENT_FQDN }}}:19092'
    - '--pandaproxy-addr internal://0.0.0.0:8082,external://0.0.0.0:18082'
    # Address the broker advertises to clients that connect to the HTTP Proxy.
    - '--advertise-pandaproxy-addr internal://brokern_{{ MORIO_NODE_NR }}:8082,external://{{{ MORIO_DEPLOYMENT_FQDN }}}:18082'
    - '--schema-registry-addr internal://0.0.0.0:8081,external://0.0.0.0:18081'
    # Redpanda brokers use the RPC API to communicate with each other internally.
    - '--rpc-addr broker_{{ MORIO_NODE_NR }}:33145'
    - '--advertise-rpc-addr broker_{{ MORIO_NODE_NR }}:33145'
    # Mode dev-container uses well-known configuration properties for development in containers.
    - '--mode dev-container'
    # enable logs for debugging.
    - '--default-log-level=debug'
  networks:
    default: null
  ports:
    - 18081:18081
    - 18082:18082
    - 19082:19082
    - 19644:19644
  volumes:
    - '{{{ MORIO_REPO_ROOT }}}/hostfs/data/broker:/var/lib/redpanda/data'
